import{a as A}from"./chunk-BQKH3SND.js";import{a as te}from"./chunk-NAFJH74I.js";import{a as ee}from"./chunk-YNWWLVIM.js";import"./chunk-LVYFRCIN.js";import{a as Z}from"./chunk-V3WS5N3F.js";import"./chunk-SR25SAAB.js";import{A as K,F as W,X,d as R,e as q,j as U,k as P,p as G,u as Y}from"./chunk-PVUOKLCY.js";import{Cb as k,Da as D,Fb as d,Gb as c,Hb as l,Ia as V,Ib as f,Jb as E,Kb as I,Lb as N,P as v,Pb as L,Qb as m,Ub as T,Vb as O,Wb as F,Xa as B,Ya as j,ab as o,cc as p,d as C,dc as z,ec as M,fb as h,gc as $,jc as J,kc as g,la as y,ma as S,mb as H,mc as Q,rb as u,tb as w}from"./chunk-3OE6TCCL.js";var ne=["channelSection"],ae=t=>({key:"tdt",title:"Canales TDT Espa\xF1a",list:t}),se=t=>({key:"movistar",title:"Canales exclusivos de Movistar+",list:t}),re=t=>({key:"online",title:"Canales de TV online en Espa\xF1a",list:t}),oe=t=>({key:"autonomo",title:"Canales Auton\xF3micos Espa\xF1a",list:t}),le=t=>({key:"deporte",title:"Canales Deportes Espa\xF1a",list:t}),ce=(t,s,a,e,i)=>[t,s,a,e,i],de=()=>[1,2,3,4,5];function pe(t,s){if(t&1&&f(0,"app-banner",11),t&2){let a=m();d("data",a.destacada)}}function me(t,s){if(t&1&&f(0,"div",12),t&2){let a=m();d("innerHTML",a.safeLdHtml,B)}}function he(t,s){if(t&1&&(c(0,"li")(1,"a",17),p(2),l()()),t&2){let a=s.$implicit,e=m(2);o(),d("href",e.url_web&&((e.url_web[a.id]==null?null:e.url_web[a.id].url)||(e.url_web[a.name]==null?null:e.url_web[a.name].url))||"#",j),o(),z(a.name||a.nombre||a.title||a.titulo)}}function ue(t,s){if(t&1&&(c(0,"section",13)(1,"h2",14),p(2," Canales populares "),l(),c(3,"p",15),p(4," Listado de canales populares para facilitar el rastreo a buscadores "),l(),c(5,"ul",16),u(6,he,3,2,"li",10),l()()),t&2){let a=m();o(6),d("ngForOf",a.topChannels)}}function fe(t,s){t&1&&f(0,"div",30)}function ge(t,s){t&1&&(c(0,"div",28),u(1,fe,1,0,"div",29),l()),t&2&&(o(),d("ngForOf",J(1,de)))}function _e(t,s){if(t&1&&(E(0),f(1,"app-slider",31),I()),t&2){let a=m().$implicit,e=m();o(),d("key",a.key)("programas",a.list),k("data-lazy",e.isBrowser?"true":"false")("aria-label","Carrusel de "+a.title)}}function be(t,s){if(t&1){let a=N();E(0),c(1,"section",18,0)(3,"div",19)(4,"h2",20),p(5),l(),c(6,"div",21)(7,"button",22),L("click",function(){let i=y(a).$implicit,n=m();return S(n.prevFor(i.key))}),p(8," \u2039 "),l(),c(9,"button",23),L("click",function(){let i=y(a).$implicit,n=m();return S(n.nextFor(i.key))}),p(10," \u203A "),l()()(),c(11,"p",24),p(12),l(),c(13,"div",25),u(14,ge,2,2,"div",26)(15,_e,2,4,"ng-container",27),l()(),I()}if(t&2){let a=s.$implicit,e=m();o(),k("data-key",a.key)("aria-labelledby","section-"+a.key+"-title"),o(3),d("id",$("section-"+a.key+"-title")),o(),M(" ",a.title," "),o(7),M(" ",a.title," \u2014 explora la programaci\xF3n y encuentra tus canales favoritos. "),o(2),d("ngIf",e.cargando),o(),d("ngIf",!e.cargando&&(e.isBrowser?e.sliderVisible[a.key]:!0))}}var Be=(()=>{let s=class s{constructor(e,i,n,r,b,x,_){this.guideSvc=e,this.httpService=i,this.metaSvc=n,this.router=r,this.http=b,this.sanitizer=x,this.platformId=_,this.nextClicked=new w,this.prevClicked=new w,this.categorias=["TDT","Cable","Autonomico"],this.canales=[],this.url_web={},this.cargando=!0,this.canales_tdt=[],this.canales_m=[],this.canales_auto=[],this.canales_dep=[],this.canales_cable=[],this.popular_movies=[],this.movieStartIndex=0,this.actorStartIndex=0,this.actor={},this.isBrowser=!1,this.sliderVisible={},this.ldJson="",this.safeLdHtml=null,this.topChannels=[]}ngOnInit(){this.isBrowser=P(this.platformId),this.setupMetaTags(),this.loadCanalesData(),this.loadProgramsData(),this.sliderVisible={tdt:!this.isBrowser,movistar:!this.isBrowser,online:!this.isBrowser,autonomo:!this.isBrowser,deporte:!this.isBrowser}}ngAfterViewInit(){this.isBrowser&&(this.intersectionObserver=new IntersectionObserver(e=>{e.forEach(i=>{let n=i.target,r=n.getAttribute("data-key")||n.id||"";r&&i.isIntersecting&&(this.sliderVisible[r]=!0,this.intersectionObserver&&this.intersectionObserver.unobserve(n))})},{root:null,rootMargin:"200px 0px",threshold:.05}),setTimeout(()=>{this.channelSections.forEach(e=>{let i=e.nativeElement,n=i.getAttribute("data-key")||i.id||"";n&&this.intersectionObserver&&!this.sliderVisible[n]&&this.intersectionObserver.observe(i)})},80))}ngOnDestroy(){this.cleanup()}setupMetaTags(){let e=this.router.url;this.metaSvc.setMetaTags({title:"Canales de TV de Espa\xF1a",description:"Listado de canales de televisi\xF3n de Espa\xF1a, como TVE, Antena 3, Telecinco, Cuatro, La Sexta, etc.",canonicalUrl:e})}loadCanalesData(){P(this.platformId)&&(this.canalesSubscription=this.http.get("/assets/canales.json").subscribe({next:e=>{this.url_web=e},error:e=>{console.error("Error loading canales:",e),this.url_web={}}}))}loadProgramsData(){try{this.programasSubscription=this.httpService.programas$.pipe(v()).subscribe(e=>C(this,null,function*(){e.length===0?yield this.loadFromApi():this.manageCanales(e)}))}catch(e){console.error("Error loading programs data:",e),this.cargando=!1}}loadFromApi(){return C(this,null,function*(){try{console.log("\u23F3 LISTA-CANALES - No hay datos, esperando a que se carguen desde HomeComponent..."),this.httpService.getProgramacion("today").pipe(v()).subscribe({next:e=>C(this,null,function*(){try{Array.isArray(e)&&e.length>0?(console.log("\u{1F4E1} LISTA-CANALES - Datos recibidos desde API (today)"),yield this.httpService.setProgramas(e,"today"),this.manageCanales(e)):(console.warn("\u26A0\uFE0F LISTA-CANALES - La API devolvi\xF3 datos vac\xEDos para today"),this.cargando=!1)}catch(i){console.error("Error processing data from API:",i),this.cargando=!1}}),error:e=>{console.error("Error loading programacion from API fallback:",e),this.cargando=!1}})}catch(e){console.error("Error in loadFromApi:",e),this.cargando=!1}})}manageCanales(e){this.guideSvc.setData(e),this.canales_auto=this.guideSvc.getAutonomicoCanales(),this.canales_tdt=this.guideSvc.getTDTCanales(),this.canales_m=this.guideSvc.getMovistarCanales(),this.canales_dep=this.guideSvc.getDeportesCanales(),this.canales_cable=this.guideSvc.getCableCanales(),this.cargando=!1,this.isBrowser&&setTimeout(()=>{Object.keys(this.sliderVisible).forEach(i=>this.sliderVisible[i]=!0)},120);try{this.buildLdJson()}catch(i){console.warn("Error building JSON-LD for channels",i)}}buildLdJson(){let e=[...this.canales_tdt,...this.canales_m,...this.canales_cable,...this.canales_auto,...this.canales_dep].filter(Boolean);this.topChannels=e.slice(0,12);let n={"@context":"https://schema.org","@type":"ItemList",name:"Listado de canales de televisi\xF3n en Espa\xF1a",description:"Listado y programaci\xF3n de los principales canales de TV en Espa\xF1a.",itemListElement:e.map((r,b)=>{let x=r.name||r.nombre||r.title||r.titulo||`Canal ${b+1}`,_=this.url_web&&(this.url_web[r.id]||this.url_web[x]||this.url_web[r.slug]),ie=_&&_.url?_.url:"";return{"@type":"ListItem",position:b+1,name:x,url:ie}}).slice(0,200)};this.ldJson=JSON.stringify(n,null,2),this.safeLdHtml=this.sanitizer.bypassSecurityTrustHtml(`<script type="application/ld+json">${this.ldJson}<\/script>`)}cleanup(){this.programasSubscription&&this.programasSubscription.unsubscribe(),this.canalesSubscription&&this.canalesSubscription.unsubscribe(),this.intersectionObserver&&(this.intersectionObserver.disconnect(),this.intersectionObserver=void 0)}canalesPorCategoria(e){return this.canales.filter(i=>i.tipo===e)}onNextClick(){this.nextClicked.emit()}onPrevClick(){this.prevClicked.emit()}prevFor(e){let i=this.sliderComponents.find(n=>n.key===e);i&&i.prev()}nextFor(e){let i=this.sliderComponents.find(n=>n.key===e);i&&i.next()}get hasCanalesTdt(){return this.canales_tdt.length>0}get hasCanalesTotales(){return this.canales_auto.length>0||this.canales_tdt.length>0||this.canales_m.length>0||this.canales_dep.length>0||this.canales_cable.length>0}get totalCanales(){return this.canales_auto.length+this.canales_tdt.length+this.canales_m.length+this.canales_dep.length+this.canales_cable.length}};s.\u0275fac=function(i){return new(i||s)(h(X),h(W),h(Z),h(K),h(G),h(Y),h(V))},s.\u0275cmp=H({type:s,selectors:[["app-lista-canales"]],viewQuery:function(i,n){if(i&1&&(T(ne,5,D),T(A,5)),i&2){let r;O(r=F())&&(n.channelSections=r),O(r=F())&&(n.sliderComponents=r)}},outputs:{nextClicked:"nextClicked",prevClicked:"prevClicked"},decls:14,vars:20,consts:[["channelSection",""],["href","#main-content",1,"skip-link","sr-only","focus:not-sr-only"],["id","main-content","role","main","aria-labelledby","page-title",1,"lista-canales","root","flex-1","py-8","px-4","sm:px-8","lg:px-12"],[1,"top"],["lazy","true",3,"data",4,"ngIf"],[1,"intro","mt-6","max-w-4xl","mx-auto","text-gray-600"],["id","page-title",1,"text-xl","font-semibold","text-gray-100"],[1,"mt-3","text-sm","leading-relaxed"],[3,"innerHTML",4,"ngIf"],["class","top-channels mt-6 max-w-4xl mx-auto text-sm text-gray-300","aria-labelledby","top-channels-title",4,"ngIf"],[4,"ngFor","ngForOf"],["lazy","true",3,"data"],[3,"innerHTML"],["aria-labelledby","top-channels-title",1,"top-channels","mt-6","max-w-4xl","mx-auto","text-sm","text-gray-300"],["id","top-channels-title",1,"text-base","font-semibold","text-gray-100"],[1,"sr-only"],[1,"grid","grid-cols-2","sm:grid-cols-3","gap-2"],["rel","noopener noreferrer",1,"text-gray-300","hover:text-red-400","underline-offset-2","focus:outline-none","focus:ring-2","focus:ring-red-400",3,"href"],[1,"channel-section","mt-8"],[1,"flex","items-center","justify-between"],[1,"font-semibold","text-gray-100","text-base",3,"id"],[1,"controls","flex","items-center","space-x-2","text-gray-400"],["aria-label","Anterior",1,"btn-nav",3,"click"],["aria-label","Siguiente",1,"btn-nav",3,"click"],[1,"mt-3","text-sm","text-gray-400"],[1,"mt-4"],["class","skeleton-grid","aria-hidden","true",4,"ngIf"],[4,"ngIf"],["aria-hidden","true",1,"skeleton-grid"],["class","s-item",4,"ngFor","ngForOf"],[1,"s-item"],["variant","canales",3,"key","programas"]],template:function(i,n){i&1&&(c(0,"a",1),p(1,"Saltar al contenido"),l(),c(2,"main",2)(3,"section",3),f(4,"app-nav-bar"),u(5,pe,1,1,"app-banner",4),l(),c(6,"section",5)(7,"h1",6),p(8," Listado de canales de televisi\xF3n en Espa\xF1a "),l(),c(9,"p",7),p(10," Consulta la programaci\xF3n de los principales canales espa\xF1oles. Filtra por TDT, Movistar+, canales online o auton\xF3micos. "),l()(),u(11,me,1,1,"div",8)(12,ue,7,1,"section",9)(13,be,16,8,"ng-container",10),l()),i&2&&(o(5),d("ngIf",n.destacada),o(6),d("ngIf",n.safeLdHtml),o(),d("ngIf",n.topChannels==null?null:n.topChannels.length),o(),d("ngForOf",Q(14,ce,g(4,ae,n.canales_tdt),g(6,se,n.canales_m),g(8,re,n.canales_cable),g(10,oe,n.canales_auto),g(12,le,n.canales_dep))))},dependencies:[U,R,q,ee,te,A],styles:['.lista-canales[_ngcontent-%COMP%]{background:transparent;color:var(--color-text, #e5e7eb)}.intro[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#fff}.channel-section[_ngcontent-%COMP%]{border-top:1px solid rgba(255,255,255,.03);padding-top:1.25rem}.controls[_ngcontent-%COMP%]   .btn-nav[_ngcontent-%COMP%]{background:linear-gradient(180deg,#ffffff08,#ffffff03);border:1px solid rgba(255,255,255,.06);color:#fffffff2;width:44px;height:44px;display:inline-flex;align-items:center;justify-content:center;border-radius:10px;cursor:pointer;transition:transform .12s ease,background .12s ease,box-shadow .12s ease}.controls[_ngcontent-%COMP%]   .btn-nav[_ngcontent-%COMP%]:hover{transform:translateY(-2px) scale(1.02);background:#dc26261f;box-shadow:0 6px 20px #00000073}.controls[_ngcontent-%COMP%]   .btn-nav[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 4px #dc26262e}.skeleton-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(110px,1fr));gap:12px}.s-item[_ngcontent-%COMP%]{height:84px;border-radius:12px;background:linear-gradient(90deg,#ffffff08,#ffffff0f,#ffffff08);position:relative;overflow:hidden}.s-item[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.04),transparent);animation:_ngcontent-%COMP%_shimmer 1.2s infinite}@keyframes _ngcontent-%COMP%_shimmer{0%{left:-100%}to{left:100%}}@media (min-width: 1024px){.lista-canales[_ngcontent-%COMP%]{padding-left:2rem;padding-right:2rem}.s-item[_ngcontent-%COMP%]{height:96px}}']});let t=s;return t})();export{Be as ListaCanalesComponent};
