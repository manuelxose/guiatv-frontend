import './polyfills.server.mjs';
import{M as B,S as W,V as A,X as w,f as F,g as L,h as $,ha as N,m as R,o as j}from"./chunk-MTFKIQB4.mjs";import{Cb as _,Ea as M,Fb as u,Fc as V,Gb as c,Hb as d,Ib as I,Lb as O,Pb as b,Qb as m,Ub as E,Vb as T,Wa as k,Wb as z,_a as s,cc as p,db as h,dc as P,ec as x,ha as g,ia as f,jc as D,kb as S,pb as v}from"./chunk-GKUCNG4B.mjs";var q=["scrollContainer"],Z=()=>[400,600,800];function G(o,a){if(o&1&&(c(0,"time"),p(1),d()),o&2){let i=m(),e=i.$implicit,t=i.index,n=m();_("datetime",e.start),s(),x(" ",n.horaInicio(t)," ")}}function H(o,a){if(o&1&&(c(0,"span",20),p(1),d()),o&2){let i=m().$implicit;s(),P(i.desc.year)}}function J(o,a){if(o&1&&(c(0,"span",21),p(1),d()),o&2){let i=m().$implicit;s(),x("\u2605 ",i.starRating)}}function K(o,a){if(o&1&&(c(0,"span",22),p(1),d()),o&2){let i=m().$implicit;s(),P(i.desc.rate)}}function X(o,a){if(o&1){let i=O();c(0,"article",5)(1,"a",6),b("click",function(){let t=g(i).$implicit,n=m();return f(n.manageData(t))})("keydown.enter",function(){let t=g(i).$implicit,n=m();return f(n.manageData(t))})("keydown.space",function(t){let n=g(i).$implicit,r=m();return t.preventDefault(),f(r.manageData(n))}),c(2,"figure",7)(3,"img",8),b("error",function(t){let n=g(i).$implicit,r=m();return f(r.onLogoError(t,n))}),d(),I(4,"div",9),c(5,"figcaption",10)(6,"div",11),v(7,G,2,2,"time",12),d(),c(8,"div",13)(9,"div",14),p(10),d(),c(11,"h3",15),p(12),d(),c(13,"div",16),v(14,H,2,1,"span",17)(15,J,2,1,"span",18)(16,K,2,1,"span",19),d()()()()()()}if(o&2){let i=a.$implicit,e=a.index,t=m();s(),_("aria-label","Ver "+((i==null||i.title==null?null:i.title.value)||(i==null?null:i.name)||"programa")),s(2),u("src",t.isFirst(e)?t.buildWsrvUrl(i==null?null:i.icon,800,450):t.posterPlaceholder,k)("srcset",t.isFirst(e)?t.buildSrcset(i==null?null:i.icon,D(13,Z)):""),_("data-src",t.buildWsrvUrl(i==null?null:i.icon,800,450))("alt",(i==null||i.title==null?null:i.title.value)||"Programa")("loading",t.isFirst(e)?"eager":"lazy")("decoding",t.isFirst(e)?"sync":"async"),s(4),u("ngIf",i==null?null:i.start),s(3),x(" ",(i==null?null:i.channel)||"Canal"," "),s(2),x(" ",(i==null||i.title==null?null:i.title.value)||"T\xEDtulo desconocido"," "),s(2),u("ngIf",i==null||i.desc==null?null:i.desc.year),s(),u("ngIf",i==null?null:i.starRating),s(),u("ngIf",i==null||i.desc==null?null:i.desc.rate)}}function ee(o,a){if(o&1){let i=O();c(0,"div",23)(1,"button",24),b("click",function(){g(i);let t=m();return f(t.prev())}),p(2," \u2039 "),d(),c(3,"button",25),b("click",function(){g(i);let t=m();return f(t.next())}),p(4," \u203A "),d()()}if(o&2){let i=m();s(),u("disabled",!i.canScrollPrev()),s(2),u("disabled",!i.canScrollNext())}}var fe=(()=>{let a=class a{constructor(e,t,n,r){this.guiatvSvc=e,this.router=t,this.platformId=n,this.cdr=r,this.programas=[],this.variant="default",this.logo="",this.isBrowser=!1,this.scrollTimeout=null,this.posterPlaceholder="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 800 450%27%3E%3Crect width=%27800%27 height=%27450%27 fill=%27%23111827%27/%3E%3C/svg%3E",this.logoPlaceholder="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 400 400%27%3E%3Crect width=%27400%27 height=%27400%27 fill=%27%23111827%27/%3E%3C/svg%3E"}ngOnInit(){this.isBrowser=j(this.platformId)}ngAfterViewInit(){!this.isBrowser||!this.scrollContainer||(this.setupIntersectionObserver(),this.setupResizeObserver())}ngOnDestroy(){this.scrollTimeout&&clearTimeout(this.scrollTimeout),this.resizeObserver?.disconnect(),this.intersectionObserver?.disconnect()}setupIntersectionObserver(){"IntersectionObserver"in window&&(this.intersectionObserver=new IntersectionObserver(e=>{e.forEach(t=>{if(t.isIntersecting){let n=t.target,r=n.getAttribute("data-src");if(r){n.src=r,n.removeAttribute("data-src");try{this.intersectionObserver?.unobserve(n)}catch{}}}})},{rootMargin:"50px",threshold:.01}),setTimeout(()=>{this.scrollContainer?.nativeElement.querySelectorAll("img[data-src]")?.forEach(t=>this.intersectionObserver?.observe(t))},100))}setupResizeObserver(){"ResizeObserver"in window&&(this.resizeObserver=new ResizeObserver(()=>{this.cdr.markForCheck()}),this.scrollContainer?.nativeElement&&this.resizeObserver.observe(this.scrollContainer.nativeElement))}scrollTo(e){if(!this.scrollContainer?.nativeElement)return;let t=this.scrollContainer.nativeElement,n=t.clientWidth*.8;t.scrollBy({left:e==="next"?n:-n,behavior:"smooth"})}next(){this.scrollTo("next")}prev(){this.scrollTo("prev")}onNextClick(){this.next()}onPrevClick(){this.prev()}hasMultipleSlides(){return Array.isArray(this.programas)&&this.programas.length>1}canScrollPrev(){return this.scrollContainer?.nativeElement?this.scrollContainer.nativeElement.scrollLeft>10:!1}canScrollNext(){if(!this.scrollContainer?.nativeElement)return!1;let e=this.scrollContainer.nativeElement,t=e.scrollWidth-e.clientWidth;return e.scrollLeft<t-10}horaInicio(e){try{return W(this.programas[e].start)}catch{return""}}isFirst(e){return e===0}horaFin(e){try{let t=this.programas[e]||{},n=t.end||t.stop||t.endTime||t.stop_date||t?.stopDate;return n?A(n):""}catch{return""}}manageData(e){if(!e)return;let t=e?.title&&(e.title.value||e.title)||e?.name||"",n=e?.category&&(e.category.value||e.category)||"";if(!!e?.programs||!e?.title&&!e?.start&&!e?.stop&&(e?.name||e?.id)){let l=w(e?.name||e?.channel||e?.id||"");this.router.navigate(["programacion-tv/ver-canal",l]);return}if(e){let l={title:typeof t=="string"?{value:t}:t,channel:(typeof e.channel=="string"?e.channel:e.channel?.name||e.channel?.channel||e.channel?.title)||e.channel||"Canal desconocido",poster:e?.poster||e?.icon,icon:e?.icon,start:this.normalizeTimeString?.(e.start)??(e.start||""),stop:this.normalizeTimeString?.(e.stop)??(e.stop||""),desc:typeof e.desc=="string"?{details:e.desc}:e.desc,category:typeof e.category=="string"?{value:e.category}:e.category,starRating:e.starRating,id:e.id||e.uuid||null,channel_id:typeof e.channel=="object"?e.channel.id||e.channel_id:e.channel_id||null};try{this.guiatvSvc.setDetallesPrograma(l)}catch{}let C=String(n||"").toLowerCase(),U=C.includes("cine")||!!e?.poster||!!e?.icon||!!e?.tmdbId||!!e?.release_date||!!e?.releaseDate,Y=C.includes("series")||/T\d/.test(String(t))||e?.type&&String(e.type).toLowerCase().includes("series"),Q=!!e?.start&&!!e?.stop&&!!e?.channel,y=w(l.title&&l.title.value||"");U?this.router.navigate(["/peliculas",y],{state:{bannerData:l}}):Y||Q?this.router.navigate(["/programas",y],{state:{bannerData:l}}):this.router.navigate(["/peliculas",y],{state:{bannerData:l}})}else{let l=w(e?.name||e?.channel||e?.id||"");this.router.navigate(["programacion-tv/ver-canal",l])}}normalizeTimeString(e){if(!e)return"";try{return e instanceof Date?e.toISOString():String(e)}catch{return String(e||"")}}buildWsrvUrl(e,t=400,n=225){if(!e)return"";try{let r=String(e),l=r.toLowerCase();return l.includes("wsrv.nl")||l.includes("?url=")?r:`https://wsrv.nl/?url=${encodeURIComponent(r)}&w=${t}&h=${n}&output=webp`}catch{return String(e)}}buildSrcset(e,t=[400,600,800]){return e?t.map(n=>`${this.buildWsrvUrl(e,n,Math.round(n*.5625))} ${n}w`).join(", "):""}getLogoSrc(e,t=400,n=225){let r=e?.icon||e?.channelLogo||e?.logo;if(r)return this.buildWsrvUrl(r,t,n);if(this.logo)return this.buildWsrvUrl(this.logo,t,n);let l=e?.channel||e?.name||e?.channelName||e?.channelId||e?.id;if(!l)return"";let C=`https://raw.githubusercontent.com/davidmuma/picons_dobleM/master/icon/${l}.png`;return this.buildWsrvUrl(C,t,n)}getOverlayIcon(e,t=120){let n=e?.icon||e?.channelLogo||e?.logo;if(n&&typeof n=="string"){let r=n.toLowerCase();if(!/poster|posters|cover|caratula|poster-large/i.test(r))return this.buildWsrvUrl(n,t,t)}return this.getLogoSrc(e,t,t)}onLogoError(e,t){let n=e?.target;if(!n)return;let r=Number(n.dataset.attempts||"0");if(r===0&&t?.icon){n.dataset.attempts="1",n.src=t.icon;return}if(r===1){n.dataset.attempts="2",n.src=this.posterPlaceholder;return}n.style.display="none"}trackByProgram(e,t){return t?.id||t?.uuid||`${t?.title?.value}-${e}`}};a.\u0275fac=function(t){return new(t||a)(h(N),h(B),h(M),h(V))},a.\u0275cmp=S({type:a,selectors:[["app-slider"]],viewQuery:function(t,n){if(t&1&&E(q,5),t&2){let r;T(r=z())&&(n.scrollContainer=r.first)}},inputs:{key:"key",programas:"programas",variant:"variant",logo:"logo"},decls:5,vars:5,consts:[["scrollContainer",""],[1,"native-slider",3,"ngClass"],["role","list",1,"slider-scroll-container"],["class","slider-item","role","listitem",4,"ngFor","ngForOf","ngForTrackBy"],["class","slider-nav","role","group","aria-label","Controles",4,"ngIf"],["role","listitem",1,"slider-item"],["role","button","tabindex","0",1,"slider-item-inner",3,"click","keydown.enter","keydown.space"],[1,"slide-media"],["sizes","(max-width: 640px) 92vw, (max-width: 1024px) 32vw, 19vw","width","800","height","450",1,"slide-image",3,"error","src","srcset"],[1,"slide-overlay"],[1,"slide-caption"],[1,"time-badge"],[4,"ngIf"],[1,"program-info"],[1,"channel-badge"],[1,"program-title"],[1,"program-meta"],["class","meta-item",4,"ngIf"],["class","meta-item rating",4,"ngIf"],["class","meta-item age-rating",4,"ngIf"],[1,"meta-item"],[1,"meta-item","rating"],[1,"meta-item","age-rating"],["role","group","aria-label","Controles",1,"slider-nav"],["type","button","aria-label","Anterior",1,"slider-nav-btn","slider-nav-prev",3,"click","disabled"],["type","button","aria-label","Siguiente",1,"slider-nav-btn","slider-nav-next",3,"click","disabled"]],template:function(t,n){t&1&&(c(0,"section",1)(1,"div",2,0),v(3,X,17,14,"article",3),d(),v(4,ee,5,2,"div",4),d()),t&2&&(u("ngClass","slider--"+(n.variant||"default")),_("aria-label","Carrusel de "+(n.variant==="peliculas"?"pel\xEDculas":n.variant==="series"?"series":"programas")),s(3),u("ngForOf",n.programas)("ngForTrackBy",n.trackByProgram),s(),u("ngIf",n.isBrowser&&n.hasMultipleSlides()))},dependencies:[R,F,L,$],styles:['@charset "UTF-8";.native-slider[_ngcontent-%COMP%]{position:relative;width:100%;margin:2.5rem 0;padding:2rem 0}@media (min-width: 1024px){.native-slider[_ngcontent-%COMP%]{margin:3.5rem 0;padding:3rem 0}}.slider-scroll-container[_ngcontent-%COMP%]{display:flex;gap:.5rem;overflow-x:auto;overflow-y:hidden;scroll-behavior:smooth;scroll-snap-type:x mandatory;-webkit-overflow-scrolling:touch;scrollbar-width:none}.slider-scroll-container[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}@media (min-width: 1024px){.slider-scroll-container[_ngcontent-%COMP%]{gap:.75rem}}.slider-item[_ngcontent-%COMP%]{flex:0 0 auto;scroll-snap-align:start;list-style:none;width:90vw}@media (min-width: 640px){.slider-item[_ngcontent-%COMP%]{width:45vw}}@media (min-width: 1024px){.slider-item[_ngcontent-%COMP%]{width:30vw}}@media (min-width: 1280px){.slider-item[_ngcontent-%COMP%]{width:24vw}}@media (min-width: 1536px){.slider-item[_ngcontent-%COMP%]{width:19vw}}.slider-item-inner[_ngcontent-%COMP%]{display:block;text-decoration:none;color:inherit;cursor:pointer}.slide-media[_ngcontent-%COMP%]{position:relative;width:100%;aspect-ratio:16/9;border-radius:6px;overflow:hidden;background:#181818;transition:all .3s cubic-bezier(.5,0,.1,1);transform:translateZ(0)}.slider-item[_ngcontent-%COMP%]:hover   .slide-media[_ngcontent-%COMP%]{transform:scale(1.1) translateY(-12px);box-shadow:0 20px 50px #000c;z-index:100}.slide-image[_ngcontent-%COMP%]{display:block;width:100%;height:100%;object-fit:cover;object-position:center;transition:transform .3s cubic-bezier(.5,0,.1,1)}.slider-item[_ngcontent-%COMP%]:hover   .slide-image[_ngcontent-%COMP%]{transform:scale(1.05)}.slide-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:linear-gradient(180deg,transparent 0%,transparent 40%,rgba(0,0,0,.4) 70%,rgba(0,0,0,.9) 100%);pointer-events:none;transition:background .3s ease}.slider-item[_ngcontent-%COMP%]:hover   .slide-overlay[_ngcontent-%COMP%]{background:linear-gradient(180deg,#0003,#0006 40%,#000000b3,#000000f2)}.slide-caption[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;flex-direction:column;justify-content:space-between;padding:1rem;pointer-events:none}@media (min-width: 1024px){.slide-caption[_ngcontent-%COMP%]{padding:1.25rem}}.time-badge[_ngcontent-%COMP%]{align-self:flex-start;background:#000000e6;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);padding:.5rem .875rem;border-radius:4px;font-size:.875rem;font-weight:700;color:#fff;box-shadow:0 4px 12px #00000080}@media (min-width: 1024px){.time-badge[_ngcontent-%COMP%]{font-size:.9375rem;padding:.625rem 1rem}}.program-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}@media (min-width: 1024px){.program-info[_ngcontent-%COMP%]{gap:.625rem}}.program-title[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;color:#fff;margin:0;line-height:1.2;text-shadow:0 2px 8px rgba(0,0,0,.8);display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;opacity:1;transform:translateY(0)}@media (min-width: 1024px){.program-title[_ngcontent-%COMP%]{font-size:1.125rem}}@media (min-width: 1280px){.program-title[_ngcontent-%COMP%]{font-size:1.25rem}}.program-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;opacity:0;transform:translateY(10px);transition:all .3s cubic-bezier(.5,0,.1,1);max-height:0;overflow:hidden}.slider-item[_ngcontent-%COMP%]:hover   .program-details[_ngcontent-%COMP%]{opacity:1;transform:translateY(0);max-height:200px}.channel-badge[_ngcontent-%COMP%]{display:inline-flex;align-self:flex-start;padding:.25rem .625rem;background:#ffffff26;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);border-radius:3px;font-size:.75rem;font-weight:700;color:#fff;text-transform:uppercase;letter-spacing:.05em}@media (min-width: 1024px){.channel-badge[_ngcontent-%COMP%]{font-size:.8125rem;padding:.3125rem .75rem}}.program-meta[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.625rem;flex-wrap:wrap}.meta-item[_ngcontent-%COMP%]{font-size:.8125rem;font-weight:600;color:#ffffffe6}@media (min-width: 1024px){.meta-item[_ngcontent-%COMP%]{font-size:.875rem}}.meta-item.rating[_ngcontent-%COMP%]{color:#fbbf24}.meta-item.duration[_ngcontent-%COMP%]{color:#ffffffd9}.meta-item.duration[_ngcontent-%COMP%]:before{content:"\\2022";margin-right:.5rem;color:#ffffff80}.meta-item.age-rating[_ngcontent-%COMP%]{padding:.125rem .375rem;background:#fff3;border-radius:2px;font-size:.75rem}.slider-nav[_ngcontent-%COMP%]{display:none}@media (min-width: 1024px){.slider-nav[_ngcontent-%COMP%]{display:block;opacity:0;transition:opacity .3s ease}}.native-slider[_ngcontent-%COMP%]:hover   .slider-nav[_ngcontent-%COMP%]{opacity:1}.slider-nav-btn[_ngcontent-%COMP%]{position:absolute;top:50%;transform:translateY(-50%);width:60px;height:60px;display:flex;align-items:center;justify-content:center;background:#141414b3;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);border:none;color:#fff;font-size:48px;font-weight:200;cursor:pointer;transition:all .2s ease;z-index:200}.slider-nav-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#141414e6;transform:translateY(-50%) scale(1.1)}.slider-nav-btn[_ngcontent-%COMP%]:disabled{opacity:.3;cursor:not-allowed}.slider-nav-prev[_ngcontent-%COMP%]{left:0;border-radius:0 4px 4px 0}.slider-nav-next[_ngcontent-%COMP%]{right:0;border-radius:4px 0 0 4px}.slider--peliculas[_ngcontent-%COMP%]   .slide-image[_ngcontent-%COMP%], .slider--series[_ngcontent-%COMP%]   .slide-image[_ngcontent-%COMP%]{object-position:center 25%}@media (prefers-reduced-motion: reduce){.slider-scroll-container[_ngcontent-%COMP%]{scroll-behavior:auto}.slide-media[_ngcontent-%COMP%], .program-info[_ngcontent-%COMP%]{transition:none!important}.slider-item[_ngcontent-%COMP%]:hover   .slide-media[_ngcontent-%COMP%]{transform:none!important}}@supports (content-visibility: auto){.slider-item[_ngcontent-%COMP%]{content-visibility:auto;contain-intrinsic-size:0 200px}}.slide-media[_ngcontent-%COMP%], .slide-image[_ngcontent-%COMP%]{transform:translateZ(0);backface-visibility:hidden}img[data-src][_ngcontent-%COMP%]{background:linear-gradient(135deg,#1f2937,#111827)}@media print{.slider-nav[_ngcontent-%COMP%]{display:none}.slider-scroll-container[_ngcontent-%COMP%]{overflow:visible;display:grid;grid-template-columns:repeat(3,1fr);gap:1rem}.slider-item[_ngcontent-%COMP%]{width:100%;page-break-inside:avoid}}'],changeDetection:0});let o=a;return o})();export{fe as a};
